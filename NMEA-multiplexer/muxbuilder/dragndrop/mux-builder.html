<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Graphical Mux Builder</title>
    <link rel="stylesheet" href="../stylesheet.css"/>
    <link rel="stylesheet" href="./style.css"/>

    <script type="text/javascript" src="./script.js"></script>
</head>

<script type="text/javascript">
// Utilities for the file-forwarder 

let fileFwdOption = (sel) => {
    console.log(`Value changed to ${sel.value}`);
    let optionId = null;
    if (sel.value === 'one-file') {
        optionId = 'file-fwd-option-one';
    } else if (sel.value === 'time-based') {
        optionId = 'file-fwd-option-two';
    }
    let specificFileOption = document.getElementById(optionId);
    let newOptionElement = specificFileOption.cloneNode(true);
    newOptionElement.style.display = 'block';
    // Find parameter's table
    let parentTable = sel;
    while (!(parentTable instanceof HTMLTableElement)) {
      parentTable = parentTable.parentElement;
    }
    let optionLocation = parentTable.querySelector('.file-fwd-prms');
      while (optionLocation.firstChild) { // Remove what's in there
        optionLocation.removeChild(optionLocation.firstChild)
      }
      optionLocation.appendChild(newOptionElement);
};
</script>

<!-- Two special cases for the Log File Forwarder -->
<div id="file-fwd-option-one" style="display: none; border-radius: 5px; border: 1px solid silver; margin: 3px;">
    <table>
        <tr>
            <td>File Name</td>
            <td><input type="text" class="logfile-name" size="30" placeholder="Log File Name"></td>
        </tr>
        <tr>
            <td>Append</td>
            <td><input type="checkbox" class="append"></td>
        </tr>
    </table>
</div>

<div id="file-fwd-option-two" style="display: none; border-radius: 5px; border: 1px solid silver; margin: 3px;">
    <table>
        <tr>
            <td>Log files suffix</td>
            <td><input type="text" class="logfile-suffix" size="30" placeholder="Log File Suffix"></td>
        </tr>
        <tr>
            <td>Log files directory</td>
            <td><input type="text" class="logfile-dir" size="30" placeholder="Log File Folder"></td>
        </tr>
        <tr>
            <td>Log files Split</td>
            <td>
                <select class="log-file-split">
                    <option value="min">Minute</option>
                    <option value="hour">Hour</option>
                    <option value="day">Day</option>
                    <option value="week">Week</option>
                    <option value="month">Month</option>
                    <option value="year">Year</option>
                </select>
            </td>
        </tr>
    </table>
</div>

<!-- Body begins here -->

<body>

<dialog id="generated-code-dialog" style="min-height: 300px; min-width: 400px; z-index: 50; border-radius: 10px; background-color: rgba(255, 255, 255, 0.85); overflow: hidden;">
    <div class="dialog-header">
      <div style="padding: 10px;">
        <span style="margin-left: 20px;">YAML content (already in clipboard)</span>
        <span class="dialog-header-close" onclick="closeGeneratedDialog();">&times</span>
      </div>
    </div>
    <div style="text-align: left; max-height: 300px; overflow-y: scroll;">
        <pre><span id="generated-yaml"></span></pre> <!-- This will contain the final result -->
    </div>
</dialog>    

<h1>Mux GUI builder</h1>

<div class="draggable-content" style="height: auto; width: auto;">
  <div>
    <label for="mux-title">MUX definition</label>
    <input type="text" id="mux-title" placeholder="MUX Title" style="width: 200px;" onblur="dumpIt();">
    <span class="edit-icon" style="display: inline-block;" onclick="edit(this.parentElement.parentElement);" title="Edit Parameters">✏️ Context</span>
  </div>
  <dialog class="editable-prm" style="min-height: 200px;">
    <div class="dialog-header">
      <div style="padding: 10px;">
        <span style="margin-left: 20px;">Edit Mux Context Parameters</span>
        <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
      </div>
    </div>
    <div class="editable-zone mux-context">
      <label for="with-http">With HTTP/REST Server</label>
      <input type="checkbox" id="with-http" onchange="expandCollapseHTTP(this);">
      <div id="http-specific" class="smooth">
          <table>
              <tr>
                  <td>
                      <label for="http-port">HTTP Port</label>
                  </td>
                  <td>
                      <input type="number" min="80" step="1" placeholder="HTTP Port number" id="http-port" value="8080">
                  </td>
              </tr>
              <tr>
                  <td>
                      <label for="init-cache">Init Cache</label>
                  </td>
                  <td>
                      <input type="checkbox" id="init-cache" checked>
                  </td>
              </tr>
          </table>
      </div>
      <div>
          <table>
              <tr>
                  <td>Default Declination</td>
                  <td><input type="number" class="declination" step="0.1" value="14.0" id="default-decl"></td>
              </tr>
              <tr>
                  <td>Deviation file name</td>
                  <td><input type="text" id="dev-file-name" placeholder="Declination csv file name"></td>
              </tr>
              <tr>
                  <td>Max Leeway Angle</td>
                  <td><input type="number" min="0" step="0.1" value="10.0" id="max-leeway"></td>
              </tr>
              <tr>
                  <td>BSP Factor</td>
                  <td><input type="number" min="0" step="0.1" value="1.0" id="bsp-factor"></td>
              </tr>
              <tr>
                  <td>AWS Factor</td>
                  <td><input type="number" min="0" step="0.1" value="1.0" id="aws-factor"></td>
              </tr>
              <tr>
                  <td>AWA Offset</td>
                  <td><input type="number" step="0.1" value="0.0" id="awa-offset"></td>
              </tr>
              <tr>
                  <td>HDG Offset</td>
                  <td><input type="number" step="0.1" value="0.0" id="hdg-offset"></td>
              </tr>
              <tr>
                  <td>Damping</td>
                  <td><input type="number" min="1" step="1" value="30" id="damping"></td>
              </tr>
          </table>
      </div>
  </div>  
  </dialog>            
</div>

<div class="message">Drag from the left, drop on the right</div>

<div class="tab">
  <button class="tablinks active" onclick="switchTab(event, 0);">Consumers</button>
  <button class="tablinks" onclick="switchTab(event, 1);">Forwarders</button>
  <button class="tablinks" onclick="switchTab(event, 2);">Computers</button>
  <div class="mess">Guaranteed 0% external libraries.</div>
</div>

<div class="top-grid-container">
  <div class="left-part">

    <div id="one" style="display: block; min-height: var(--d-zone-height);">
      <!-- One row, 2 columns -->
      <div class="grid-container">

        <div class="message smaller">Available Consumers (aka Input Channels)</div>
        <div class="message smaller">Drop Consumers below</div>

        <div class="vertical-scrollable-zone side-div">
          <!-- TODO Add the REST Consumer, when ready -->
          <div id="consumer-1" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
              <div>
                <span class="close-icon" onclick="remove(this);">&times;</span>
                <span class="channel-description">Serial port input</span>
              </div>
              <div class="draggable-content">
                  <span>Serial </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                  <dialog class="editable-prm" style="min-height: 200px;">
                    <div class="dialog-header">
                      <div style="padding: 10px;">
                        <span style="margin-left: 20px;">Edit Serial Channel Parameters</span>
                        <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                      </div>
                    </div>
                    <div class="editable-zone serial-channel">
                      <table>
                          <tr>
                              <td>Comment</td>
                              <td><input type="text" class="serial-comment" size="30" placeholder="Optional"></td>
                          </tr>
                        <tr>
                            <td>Port Name</td>
                            <td><input type="text" class="port-name" size="30" placeholder="Serial Port Name"></td>
                        </tr>
                        <tr>
                            <td>Baud Rate</td>
                            <td><input type="number" class="baud-rate" placeholder="Baud Rate"></td>
                        </tr>
                        <tr>
                            <td>Device Filters</td>
                            <td><input type="text" class="device-filter" placeholder="Device Filters" size="30" title="Comma separated list"></td>
                        </tr>
                        <tr>
                            <td>Sentence Filters</td>
                            <td><input type="text" class="sentence-filter" placeholder="Sentence Filters" size="30" title="Like RMC, GLL,&#13;~GSV, ~GGA to negate the filter."></td>
                        </tr>
                        <tr>
                            <td>Verbose</td>
                            <td><input type="checkbox" class="verbose"></td>
                        </tr>
                        <tr>
                            <td>Reset Interval</td>
                            <td><input type="number" class="reset-interval" placeholder="Reset Interval" value="60000"></td>
                        </tr>
                      </table>
                    </div>
                  </dialog>
              </div>
          </div>
          <div id="consumer-2" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
              <div>
                <span class="close-icon" onclick="remove(this);">&times;</span>
                <span class="channel-description">TCP server input</span>
              </div>
              <div class="draggable-content">
                <span>TCP </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit TCP Channel Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone tcp-channel">
                    <table>
                      <tr>
                          <td>Server name or IP</td>
                          <td><input type="text" class="server-name" size="30" placeholder="Server Name"></td>
                      </tr>
                      <tr>
                          <td>Port</td>
                          <td><input type="number" class="port-num" placeholder="TCP Port"></td>
                      </tr>
                      <tr>
                          <td>Device Filters</td>
                          <td><input type="text" class="device-filter" placeholder="Device Filters" size="30" title="Comma separated list"></td>
                      </tr>
                      <tr>
                          <td>Sentence Filters</td>
                          <td><input type="text" class="sentence-filter" placeholder="Sentence Filters" size="30" title="Like RMC, GLL,&#13;~GSV, ~GGA to negate the filter."></td>
                      </tr>
                      <tr>
                          <td>Verbose</td>
                          <td><input type="checkbox" class="verbose"></td>
                      </tr>
                    </table>
                  </div>
                </dialog>
            </div>
        </div>
          <div id="consumer-3" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="channel-description">Log file replay</span>
            </div>
            <div class="draggable-content">
              <span>File </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
              <dialog class="editable-prm" style="min-height: 200px;">
                <div class="dialog-header">
                  <div style="padding: 10px;">
                    <span style="margin-left: 20px;">Edit File Channel Parameters</span>
                    <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                  </div>
                </div>
                <div class="editable-zone file-channel">
                  <table>
                    <tr>
                        <td>File Name</td>
                        <td><input type="text" class="file-name" size="30" placeholder="Log File Name"></td>
                    </tr>
                    <tr>
                        <td>Zip</td>
                        <td><input type="checkbox" class="zip-option"></td>
                    </tr>
                    <tr>
                        <td>Path in Zip</td>
                        <td><input type="text" class="zip-path" size="30" placeholder="Path in Zip"></td>
                    </tr>
                    <tr>
                        <td>Device Filters</td>
                        <td><input type="text" class="device-filter" placeholder="Device Filters" size="30" title="Comma separated list"></td>
                    </tr>
                    <tr>
                        <td>Sentence Filters</td>
                        <td><input type="text" class="sentence-filter" placeholder="Sentence Filters" size="30" title="Like RMC, GLL,&#13;~GSV, ~GGA to negate the filter."></td>
                    </tr>
                    <tr>
                        <td>Verbose</td>
                        <td><input type="checkbox" class="verbose"></td>
                    </tr>
                    <tr>
                        <td>Between records</td>
                        <td><input type="number" class="between-records" placeholder="1000"></td>
                    </tr>
                    <tr>
                        <td>Loop</td>
                        <td><input type="checkbox" class="loop"></td>
                    </tr>
                  </table>
                </div>  
              </dialog>            
            </div>
          </div>
          <div id="consumer-4" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="channel-description">WebSocket input</span>
            </div>
            <div class="draggable-content">
              <span>WebSocket </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
              <dialog class="editable-prm" style="min-height: 200px;">
                <div class="dialog-header">
                  <div style="padding: 10px;">
                    <span style="margin-left: 20px;">Edit WebSocket Channel Parameters</span>
                    <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                  </div>
                </div>
                <div class="editable-zone ws-channel">
                  <table>
                    <tr>
                        <td>WS URL</td>
                        <td><input type="text" class="ws-url" size="30" placeholder="ws://machine-address:port/path"></td>
                    </tr>
                    <tr>
                        <td>Device Filters</td>
                        <td><input type="text" class="device-filter" placeholder="Device Filters" size="30" title="Comma separated list"></td>
                    </tr>
                    <tr>
                        <td>Sentence Filters</td>
                        <td><input type="text" class="sentence-filter" placeholder="Sentence Filters" size="30" title="Like RMC, GLL,&#13;~GSV, ~GGA to negate the filter."></td>
                    </tr>
                    <tr>
                        <td>Verbose</td>
                        <td><input type="checkbox" class="verbose"></td>
                    </tr>
                  </table>
                </div>  
              </dialog>            
            </div>
          </div>
          <div id="consumer-5" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="channel-description">Temperature & Humidity Sensor input</span>
            </div>
            <div class="draggable-content">
                <span>HTU21DF </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit HTU21DF Channel Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone htu21df-channel">
                    <table>
                      <tr>
                          <td>Device Prefix</td>
                          <td><input type="text" class="device-prefix" placeholder="Device Prefix" size="30" title="Device Prefix, 2 characters"></td>
                      </tr>
                      <tr>
                          <td>Verbose</td>
                          <td><input type="checkbox" class="verbose"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>            
              </div>
          </div>
          <div id="consumer-6" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="channel-description">Temperature, Humidity, Pressure Sensor input</span>
            </div>
            <div class="draggable-content">
                <span>BME280 </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit BME280 Channel Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone bme280-channel">
                    <table>
                      <tr>
                          <td>Device Prefix</td>
                          <td><input type="text" class="device-prefix" placeholder="Device Prefix" size="30" title="Device Prefix, 2 characters"></td>
                      </tr>
                      <tr>
                          <td>Verbose</td>
                          <td><input type="checkbox" class="verbose"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>            
              </div>
          </div>
          <div id="consumer-7" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="channel-description">Temperature, Humidity, Pressure Sensor input</span>
            </div>
            <div class="draggable-content">
                <span>BMP180 </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit BMP180 Channel Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone bmp180-channel">
                    <table>
                      <tr>
                          <td>Device Prefix</td>
                          <td><input type="text" class="device-prefix" placeholder="Device Prefix" size="30" title="Device Prefix, 2 characters"></td>
                      </tr>
                      <tr>
                          <td>Verbose</td>
                          <td><input type="checkbox" class="verbose"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>            
              </div>
          </div>
          <div id="consumer-8" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="channel-description">Magnetometer Sensor input</span>
            </div>
            <div class="draggable-content">
                <span>HCM5883L </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit HCM5883L Channel Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone hcm5883l-channel">
                    <table>
                      <tr>
                          <td>Device Prefix</td>
                          <td><input type="text" class="device-prefix" placeholder="Device Prefix" size="30" title="Device Prefix, 2 characters"></td>
                      </tr>
                      <tr>
                          <td>Heading Offset</td>
                          <td><input type="number" class="heading-offset" step="1" placeholder="Heading Offset"></td>
                      </tr>
                      <tr>
                          <td>Damping size</td>
                          <td><input type="number" class="damping-size" step="1" placeholder="Damping Size" value="5"></td>
                      </tr>
                      <tr>
                          <td>Read Frequency</td>
                          <td><input type="number" class="read-frequency" step="1" placeholder="Read Frequency in ms" value="1000"></td>
                      </tr>
                      <tr>
                          <td>Calibration properties file</td>
                          <td><input type="text" class="calibration-properties" placeholder="Calibration properties file" size="30"></td>
                      </tr>
                      <tr>
                          <td>Sentence Filters</td>
                          <td><input type="text" class="sentence-filter" placeholder="Sentence Filters" size="30" title="Like RMC, GLL,&#13;~GSV, ~GGA to negate the filter."></td>
                      </tr>
                      <tr>
                          <td>Verbose</td>
                          <td><input type="checkbox" class="verbose"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>            
              </div>
          </div>
          <div id="consumer-9" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="channel-description">Magnetometer Accelerometer Sensor input</span>
            </div>
            <div class="draggable-content">
                <span>LSM303 </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit LSM303 Channel Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone lsm303-channel">
                    <table>
                      <tr>
                          <td>Device Prefix</td>
                          <td><input type="text" class="device-prefix" placeholder="Device Prefix" size="30" title="Device Prefix, 2 characters"></td>
                      </tr>
                      <tr>
                          <td>Heading Offset</td>
                          <td><input type="number" class="heading-offset" step="1" placeholder="Heading Offset"></td>
                      </tr>
                      <tr>
                          <td>Damping size</td>
                          <td><input type="number" class="damping-size" step="1" placeholder="Damping Size" value="5"></td>
                      </tr>
                      <tr>
                          <td>Read Frequency</td>
                          <td><input type="number" class="read-frequency" step="1" placeholder="Read Frequency in ms" value="1000"></td>
                      </tr>
                      <tr>
                          <td>Feature</td>
                          <td>
                              <select class="lsm-303-feature">
                                  <option value="BOTH">Both</option>
                                  <option value="MAGNETOMETER">Magnetometer</option>
                                  <option value="ACCELEROMETER">Accelerometer</option>
                              </select>
                          </td>
                      </tr>
                      <tr>
                          <td>Calibration properties file</td>
                          <td><input type="text" class="calibration-properties" placeholder="Calibration properties file" size="30"></td>
                      </tr>
                      <tr>
                          <td>Sentence Filters</td>
                          <td><input type="text" class="sentence-filter" placeholder="Sentence Filters" size="30" title="Like RMC, GLL,&#13;~GSV, ~GGA to negate the filter."></td>
                      </tr>
                      <tr>
                          <td>Verbose</td>
                          <td><input type="checkbox" class="verbose"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>            
              </div>
          </div>
          <div id="consumer-10" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="channel-description">UTC Time NMEA input</span>
            </div>
            <div class="draggable-content">
                <span>ZDA </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit ZDA Channel Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone zda-channel">
                    <table>
                      <tr>
                          <td>Verbose</td>
                          <td><input type="checkbox" class="verbose"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>            
              </div>
          </div>
          <div id="consumer-11" draggable="true" class="draggable-container draggable-channel" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="channel-description">Random input (for debug)</span>
            </div>
            <div class="draggable-content">
                <span>RND </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit RND Channel Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone rnd-channel">
                    <table>
                      <tr>
                          <td>Verbose</td>
                          <td><input type="checkbox" class="verbose"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>            
              </div>
          </div>
          <!-- End of Consumers List -->
        </div>

        <div class="vertical-scrollable-zone">
            <!-- This is where things are dropped -->
            <div id="drop-div-consumers" 
                 class="drop-container drop-container-content" 
                 ondrop="drop(event)" 
                 ondragover="allowDrop(event)">
            </div>
        </div>

      </div>
    </div>

    <div id="two" style="display: none; min-height: var(--d-zone-height);">
      <div class="grid-container" style="min-height: var(--d-zone-height);">

        <div class="message smaller">Available Forwarders</div>
        <div class="message smaller">Drop Forwarders below</div>
      
        <div class="vertical-scrollable-zone side-div">
          <div id="forwarder-8" draggable="true" class="draggable-container draggable-forwarder" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="forwarder-description">Log File</span>
            </div>
            <div class="draggable-content">
                <span>File </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit File Forwarder Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone file-forwarder">
                    <table>
                      <tr>
                          <td>Option</td>
                          <td>
                              <select onchange="fileFwdOption(this);" class="file-fwd-option">
                                  <option value="one-file">One log file</option>
                                  <option value="time-based">Time based file names</option>
                              </select>
                          </td>
                      </tr>
                      <tr>
                          <td class="file-fwd-prms" colspan="2">
                                  Placeholder
                          </td>
                      </tr>
                      <tr>
                          <td>Flush</td>
                          <td><input type="checkbox" class="flush"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>    
            </div>
          </div>

          <div id="forwarder-1" draggable="true" class="draggable-container draggable-forwarder" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="forwarder-description">Serial port output</span>
            </div>
            <div class="draggable-content">
                <span>Serial </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit Serial Forwarder Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone serial-forwarder">
                    <table>
                      <tr>
                          <td>Port Name</td>
                          <td><input type="text" class="port-name" size="30" placeholder="Serial Port Name"></td>
                      </tr>
                      <tr>
                          <td>Baud Rate</td>
                          <td><input type="number" class="baud-rate" placeholder="Baud Rate"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>            
            </div>
          </div>

          <div id="forwarder-2" draggable="true" class="draggable-container draggable-forwarder" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="forwarder-description">TCP Server output</span>
            </div>
            <div class="draggable-content">
                <span>TCP </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit TCP Forwarder Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone tcp-forwarder">
                    <table>
                      <tr>
                          <td>Port</td>
                          <td><input type="number" class="port-num" placeholder="TCP Port"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>    
            </div>
          </div>

          <div id="forwarder-3" draggable="true" class="draggable-container draggable-forwarder" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="forwarder-description">GPSD Server</span>
            </div>
            <div class="draggable-content">
                <span>GPSD </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit GPSD Forwarder Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone gpsd-forwarder">
                    <table>
                      <tr>
                          <td>Port</td>
                          <td><input type="number" class="port-num" placeholder="GPSD Port" value="2947"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>    
            </div>
          </div>

          <div id="forwarder-4" draggable="true" class="draggable-container draggable-forwarder" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="forwarder-description">WebSocket forwarder</span>
            </div>
            <div class="draggable-content">
                <span>WebSocket </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit WebSocket Forwarder Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone ws-forwarder">
                    <table>
                      <tr>
                          <td>WebSocket URI</td>
                          <td><input type="text" class="ws-uri" placeholder="WS uri"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>    
            </div>
          </div>

          <div id="forwarder-5" draggable="true" class="draggable-container draggable-forwarder" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="forwarder-description">RMI Forwarder</span>
            </div>
            <div class="draggable-content">
                <span>RMI Server </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit RMI Forwarder Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone rmi-forwarder">
                    <table>
                      <tr>
                          <td>RMI port</td>
                          <td><input type="number" class="port-num" placeholder="RMI Port" value="1099"></td>
                      </tr>
                      <tr>
                          <td>RMI name</td>
                          <td><input type="text" class="rmi-name" placeholder="RMI Name" value="RMI-NMEA"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>    
            </div>
          </div>

          <div id="forwarder-6" draggable="true" class="draggable-container draggable-forwarder" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="forwarder-description">Console Output</span>
            </div>
            <div class="draggable-content">
                <span>Console </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit Console Forwarder Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone console-forwarder">
                    <table>
                      <tr>
                          <td>No parameter</td>
                      </tr>
                    </table>
                  </div>  
                </dialog>    
            </div>
          </div>

          <div id="forwarder-7" draggable="true" class="draggable-container draggable-forwarder" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="forwarder-description">REST Forwarder</span>
            </div>
            <div class="draggable-content">
                <span>REST </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit REST Forwarder Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone rest-forwarder">
                    <table>
                      <tr>
                          <td>Server</td>
                          <td><input type="text" class="server-name" size="30" placeholder="Server Name or IP"></td>
                      </tr>
                      <tr>
                          <td>Port</td>
                          <td><input type="number" class="server-port" placeholder="Server Port" value="8080"></td>
                      </tr>
                      <tr>
                          <td>Resource</td>
                          <td><input type="text" class="server-resource" size="30" placeholder="/mux/nmea-sentence"></td>
                      </tr>
                      <tr>
                          <td>Verb</td>
                          <td>
                              <select class="rest-verb">
                                  <option value="POST">POST</option>
                                  <option value="PUT">PUT</option>
                                  <option value="PATCH">PATCH</option>
                              </select>
                          </td>
                      </tr>
                      <tr>
                          <td>Protocol</td>
                          <td>
                              <select class="rest-protocol">
                                  <option value="http">http</option>
                                  <option value="https">https</option>
                              </select>
                          </td>
                      </tr>
                      <tr>
                          <td>Header(s)</td>
                          <td><input type="text" class="rest-headers" size="30" placeholder="REST Headers" value="Content-Type:plain/text"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>    
            </div>
          </div>

          <div id="forwarder-9" draggable="true" class="draggable-container draggable-forwarder" ondragstart="drag(event)">
                <div>
                    <span class="close-icon" onclick="remove(this);">&times;</span>
                    <span class="forwarder-description">Dynamically Loaded Forwarder</span>
                </div>
                <div class="draggable-content">
                    <span>Dynamic </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                    <dialog class="editable-prm" style="min-height: 200px;">
                        <div class="dialog-header">
                            <div style="padding: 10px;">
                                <span style="margin-left: 20px;">Edit Forwarder Parameters</span>
                                <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                            </div>
                        </div>
                        <div class="editable-zone dynamic-forwarder">
                            <table>
                                <tr>
                                    <td>Class Name</td>
                                    <td><input type="text" class="dyn-class-name" size="30" placeholder="nmea.type.ClassName"></td>
                                </tr>
                                <tr>
                                    <td>Properties file</td>
                                    <td><input type="text" class="dyn-props-name" size="30" placeholder="props.properties"></td>
                                </tr>
                            </table>
                        </div>
                    </dialog>
                </div>
            </div>

            <!--div id="forwarder-X" draggable="true" class="draggable-container draggable-forwarder" ondragstart="drag(event)">
              <div>
                <span class="close-icon" onclick="remove(this);">&times;</span>
                <span class="forwarder-description">Sample output (for example)</span>
              </div>
              <div class="draggable-content">
                  <span>Sample </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                  <dialog class="editable-prm" style="min-height: 200px;">
                    <div class="dialog-header">
                      <div style="padding: 10px;">
                        <span style="margin-left: 20px;">Edit Sample Forwarder Parameters</span>
                        <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                      </div>
                    </div>
                    <div class="editable-zone sample-forwarder">
                      . . .
                    </div>
                  </dialog>
              </div>
            </div-->

          <!-- End of Forwarders List -->
        </div>  

        <div class="vertical-scrollable-zone">
          <!-- This is where things are dropped -->
          <div id="drop-div-forwarders" 
               class="drop-container drop-container-content" 
               ondrop="drop(event)" 
               ondragover="allowDrop(event)">
          </div>
        </div>  
      </div>
    </div>

    <div id="three" style="display: none; min-height: var(--d-zone-height);">
      <div class="grid-container" style="min-height: var(--d-zone-height);">

        <div class="message smaller">Available Computers</div>
        <div class="message smaller">Drop Computers below</div>
      
        <div class="vertical-scrollable-zone side-div">
          <div id="computer-1" draggable="true" class="draggable-container draggable-computer" ondragstart="drag(event)">
            <div>
              <span class="close-icon" onclick="remove(this);">&times;</span>
              <span class="computer-description">TW/GPS Current Computer</span>
            </div>
            <div class="draggable-content">
                <span>TW Current  </span><span class="edit-icon" onclick="edit(this);" title="Edit Parameters">✏️</span>
                <dialog class="editable-prm" style="min-height: 200px;">
                  <div class="dialog-header">
                    <div style="padding: 10px;">
                      <span style="margin-left: 20px;">Edit Current Computer Parameters</span>
                      <span class="dialog-header-close" onclick="closeDialog(this);">&times</span>
                    </div>
                  </div>
                  <div class="editable-zone tw-cc-computer">
                    <table>
                      <tr>
                          <td>Prefix</td>
                          <td><input type="text" class="device-prefix" placeholder="Device Prefix" value="CC"></td>
                      </tr>
                      <tr>
                          <td>Time Buffer Length</td>
                          <td><input type="text" class="time-buffer-length" placeholder="Comma separated, in milliseconds" value="30, 60, 600"></td>
                      </tr>
                    </table>
                  </div>  
                </dialog>            
              </div>
          </div>

          <!-- End of Computers -->
          
        </div>  

        <div class="vertical-scrollable-zone">
          <!-- This is where things are dropped -->
          <div id="drop-div-computers" 
               class="drop-container drop-container-content" 
               ondrop="drop(event)" 
               ondragover="allowDrop(event)">
          </div>
        </div>  
      </div>
    </div>

  </div>

  <!-- dynamically generated yaml -->
  <div class="right-part" style="padding: 10px;">
    <div class="message smaller">Generated YAML</div>
    <div class="vertical-scrollable-zone drop-container-content" style="min-height: calc(var(--d-zone-height) - 20px); max-height: calc(var(--d-zone-height) - 20px);">
      <pre><span id="dynamic-yaml" title="Generated Yaml" withPlaceholder="true" placeholder-text="Generated YAML will go here..."></span></pre>
    </div>
  </div>
</div>

<button onclick="dumpIt(true);" title="Will put it in the clipboard too."><span style="margin: 20px;">Generate YAML</span></button>

</body>
</html>