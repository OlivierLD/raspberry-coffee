<!DOCTYPE html>
<html>
  <head>
    <!--meta charset="windows-1252"-->
    <!--meta charset="iso-8859-1"-->
    <!--meta charset="utf-8"-->
    <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1">
    <title>QR Codes Generator</title>
    <link rel="stylesheet" href="css/stylesheet.css" type="text/css"/>
    <script type="text/javascript" src="js/jquery-2.1.3.js"></script>
    <script type="text/javascript" src="js/qrcode.js"></script>
    <script type="text/javascript">

  window.onload = () => {
    document.getElementById('server-ip').value = document.location.hostname;
    makeCode();
  };

    </script>
  </head>
  <body style="background-color: rgba(255, 255, 255, 0.2); background-image: none;">
    <h2>QR Codes Generator</h2>
    <hr>
    <h4 style="color: cyan;">Generate the QR code for the URL you want, and scan it with the QR Code scanner of your tablet or smart-phone, or whatever can read a QR-code.</h4>
    <hr>
    <table cellspacing="10">
      <tr>
        <td valign="top">
          <table>
            <tr>
              <td style="text-align: right;">Server's name or IP address</td><td><input id="server-ip" type="text" value="192.168.1.1" style="width:200px;" placeholder="Name or IP"/></td>
            </tr>
            <tr>
              <td style="text-align: right;">Port</td><td><input id="data-port" type="text" value="9999" style="width:100px; text-align: right;" placeholder="Data port"/></td>
            </tr>
            <tr>
              <td style="text-align: right;">Path and QS parameters</td><td><input id="path-prms" type="text" value="/" style="width:200px;" placeholder="/what/not?this=that&a=OK"/></td>
            </tr>
          </table>
        </td>
        <td valign="top">
          <table>
            <tr>
              <td valign="top">
                <div id="url-2-display"></div>
              </td>
            </tr>
            <tr>
              <td valign="top">
                <div id="qrcode" style="width:250px; height:250px; margin-top:15px;"></div>
                  <script type="text/javascript">

let qrcode = new QRCode(document.getElementById("qrcode"), {
  width:  250,
  height: 250
});

function makeCode() {
  let server = document.getElementById("server-ip");
  let dataport = document.getElementById("data-port");
  let pathprms = document.getElementById("path-prms");

  let toDisplay = 'http://' + server.value + ':' + (dataport.value.length === 0 ? "80" : dataport.value) + pathprms.value;

  try { 
    document.getElementById("url-2-display").innerHTML = "<a href='" + toDisplay + "' target='test' title='Test me'>" + toDisplay + "</a>"; 
  } catch (err) {}
  qrcode.makeCode(toDisplay);
}

makeCode();

$("#server-ip").on("blur", function() {
  makeCode();
}).on("keydown", function(e) {
  makeCode();
});
$("#data-port").on("blur", function() {
  makeCode();
}).on("keydown", function(e) {
  makeCode();
});
$("#path-prms").on("blur", function() {
  makeCode();
}).on("keydown", function(e) {
  makeCode();
});
                </script>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
    <hr>
    <address>QR Codes</address>
  </body>
</html>
